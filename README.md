Modifications include non-blocking, and return of KoD codes. 
